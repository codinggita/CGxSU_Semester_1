# JavaScript Curriculum Standards & Conventions

**Version:** 2.0.0
**Last Updated:** 2025-11-22
**Target:** Node.js 18+ LTS, Modern Browsers (ES2021+)

---

## Table of Contents

1. [Overview](#overview)
2. [Code Style & Formatting](#code-style--formatting)
3. [Module System](#module-system)
4. [Naming Conventions](#naming-conventions)
5. [Testing Standards](#testing-standards)
6. [Documentation Standards](#documentation-standards)
7. [Security Best Practices](#security-best-practices)
8. [Performance Guidelines](#performance-guidelines)
9. [Tooling & Setup](#tooling--setup)
10. [TypeScript Integration](#typescript-integration)

---

## Overview

This document defines the official coding standards, conventions, and best practices for all JavaScript content in this curriculum. Every file, example, exercise, and project must adhere to these standards to ensure consistency, quality, and pedagogical excellence.

### Goals

- **Consistency:** Uniform code style across all materials
- **Clarity:** Code that teaches and demonstrates best practices
- **Correctness:** Technically accurate, bug-free implementations
- **Modernity:** Use latest stable JavaScript features (ES2021+)
- **Testability:** All code examples include automated verification
- **Security:** Safe patterns that avoid common vulnerabilities

---

## Code Style & Formatting

### Style Guide

We follow **Airbnb JavaScript Style Guide** with custom modifications for educational clarity.

**Configuration files:**
- `.eslintrc.json` - Linting rules
- `.prettierrc` - Formatting rules

### Core Style Rules

```javascript
// ✅ CORRECT: Modern const/let, no var
const MAX_USERS = 100;
let currentCount = 0;

// ❌ WRONG: Using var
var oldStyle = 'avoid this';

// ✅ CORRECT: Arrow functions for callbacks
const numbers = [1, 2, 3].map(n => n * 2);

// ❌ WRONG: Unnecessary function keyword
const numbers = [1, 2, 3].map(function(n) { return n * 2; });

// ✅ CORRECT: Template literals
const message = `User ${name} has ${count} items`;

// ❌ WRONG: String concatenation
const message = 'User ' + name + ' has ' + count + ' items';

// ✅ CORRECT: Destructuring
const { username, email } = user;
const [first, second] = array;

// ❌ WRONG: Manual property access
const username = user.username;
const email = user.email;

// ✅ CORRECT: Object shorthand
const createUser = (name, age) => ({ name, age });

// ❌ WRONG: Redundant property names
const createUser = (name, age) => ({ name: name, age: age });

// ✅ CORRECT: Spread operator
const merged = { ...defaults, ...userOptions };
const copied = [...original];

// ❌ WRONG: Object.assign or array concat
const merged = Object.assign({}, defaults, userOptions);
```

### Indentation & Spacing

- **2 spaces** for indentation (no tabs)
- **Max line length:** 100 characters (relaxed for strings/templates)
- **Semicolons:** Required
- **Trailing commas:** Required for multiline (ES5 style)
- **Arrow function parentheses:** Omit for single parameter

```javascript
// ✅ CORRECT
const add = (a, b) => a + b;
const square = x => x * x;

const user = {
  name: 'Alice',
  age: 30,
  email: 'alice@example.com', // Trailing comma
};

// ❌ WRONG
const add = (a, b) => { return a + b; };  // Unnecessary braces
const square = (x) => x * x;  // Unnecessary parentheses
```

### Comments & Documentation

```javascript
/**
 * Calculates the factorial of a number using recursion.
 *
 * @param {number} n - A non-negative integer
 * @returns {number} The factorial of n
 * @throws {Error} If n is negative
 *
 * @example
 * factorial(5); // Returns 120
 * factorial(0); // Returns 1
 */
const factorial = n => {
  if (n < 0) throw new Error('Factorial undefined for negative numbers');
  if (n === 0 || n === 1) return 1;
  return n * factorial(n - 1);
};

// Inline comments explain "why", not "what"
// ✅ CORRECT
const delay = 300; // Debounce delay to prevent excessive API calls

// ❌ WRONG
const delay = 300; // Set delay to 300
```

---

## Module System

### Default: ES Modules (ESM)

All new code uses **ES Modules** (`import`/`export`) unless compatibility requires CommonJS.

```javascript
// ✅ CORRECT: ES Modules (modern)
// math.js
export const add = (a, b) => a + b;
export const multiply = (a, b) => a * b;
export default { add, multiply };

// main.js
import mathUtils, { add } from './math.js';

// ❌ AVOID: CommonJS (legacy, only when required)
// math.js
module.exports = {
  add: (a, b) => a + b,
};

// main.js
const { add } = require('./math.js');
```

### File Extensions

- `.js` - Standard JavaScript (ESM in this repo)
- `.mjs` - Explicit ES Module (use when mixing with CommonJS)
- `.cjs` - Explicit CommonJS (legacy Node.js modules)
- `.test.js` / `.spec.js` - Test files
- `.d.ts` - TypeScript type definitions

### Package.json Type

```json
{
  "type": "module"
}
```

This makes `.js` files default to ESM. CommonJS requires `.cjs` extension.

---

## Naming Conventions

### Variables & Functions

```javascript
// camelCase for variables and functions
const userName = 'Alice';
const calculateTotal = (items) => items.reduce((sum, item) => sum + item.price, 0);

// PascalCase for classes and constructors
class UserAccount {
  constructor(name) {
    this.name = name;
  }
}

// UPPER_SNAKE_CASE for constants
const MAX_RETRY_ATTEMPTS = 3;
const API_BASE_URL = 'https://api.example.com';

// Prefix with _ for private/internal (convention, not enforced)
class Counter {
  _internalState = 0;

  increment() {
    this._internalState++;
  }
}
```

### Files & Directories

```
// Directories: lowercase with hyphens
async-patterns/
error-handling/
01-fundamentals/

// Files: lowercase with hyphens or underscores
user-service.js
fetch-api-examples.js
01-variables.md

// Special files: specific naming
README.md
package.json
.eslintrc.json
index.js (entry point)
```

---

## Testing Standards

### Framework: Vitest

We use **Vitest** (fast, modern, Vite-powered) for all testing.

### Test File Structure

```javascript
// math.test.js
import { describe, it, expect, beforeEach, afterEach } from 'vitest';
import { add, multiply, divide } from './math.js';

describe('Math utilities', () => {
  describe('add()', () => {
    it('should add two positive numbers', () => {
      expect(add(2, 3)).toBe(5);
    });

    it('should handle negative numbers', () => {
      expect(add(-5, 3)).toBe(-2);
    });

    it('should handle zero', () => {
      expect(add(0, 0)).toBe(0);
    });
  });

  describe('divide()', () => {
    it('should divide two numbers', () => {
      expect(divide(10, 2)).toBe(5);
    });

    it('should throw error when dividing by zero', () => {
      expect(() => divide(10, 0)).toThrow('Cannot divide by zero');
    });
  });
});
```

### Test Coverage Goals

- **Unit tests:** 80%+ coverage for utility functions and modules
- **Integration tests:** Critical user flows and API interactions
- **E2E tests:** Major features in browser/DOM examples

### Running Tests

```bash
npm test              # Run all tests
npm run test:ui       # Interactive test UI
npm run test:coverage # Generate coverage report
```

---

## Documentation Standards

### File Structure

Every tutorial/lesson file must include:

```markdown
# Topic Title

**Difficulty:** Introductory | Intermediate | Advanced
**Estimated Time:** 20-40 minutes
**Prerequisites:** Node.js 18+, basic JavaScript knowledge
**Target:** Node.js 18+ LTS, Browsers (Chrome 90+, Firefox 88+, Safari 14+)

---

## Learning Objectives

By the end of this lesson, you will be able to:

1. Understand [concept A] and its use cases
2. Implement [pattern B] in production code
3. Debug common issues with [feature C]
4. Apply [technique D] to solve real-world problems
5. Evaluate trade-offs between [approach X] and [approach Y]

---

## Table of Contents

1. [Introduction](#introduction)
2. [Core Concepts](#core-concepts)
3. [Syntax & Notation](#syntax--notation)
4. [Worked Examples](#worked-examples)
5. [Exercises](#exercises)
6. [Practical Applications](#practical-applications)
7. [Common Pitfalls](#common-pitfalls)
8. [Testing & Verification](#testing--verification)
9. [Summary & Next Steps](#summary--next-steps)
10. [References](#references)

---

## Introduction

[Clear, engaging introduction explaining why this topic matters...]

---

## Core Concepts

[Formal definitions, theory, mental models...]

---

## Worked Examples

### Example 1: Basic [Topic] (Simple)
### Example 2: Real-world [Topic] (Intermediate)
### Example 3: Advanced [Topic] (Complex)

---

## Exercises

### Exercise 1: [Title] (Difficulty: Easy)
### Exercise 2: [Title] (Difficulty: Medium)
### Exercise 3: [Title] (Difficulty: Hard)
[... 5+ exercises total ...]

---

## Summary & Next Steps

### Key Takeaways
- Bullet point 1
- Bullet point 2

### Related Topics
- [Topic A](./link-to-topic-a.md)
- [Topic B](./link-to-topic-b.md)

### Further Reading
- [MDN: Topic Name](https://developer.mozilla.org/...)
- [Node.js Docs: Topic](https://nodejs.org/docs/...)

---
```

### Code Example Template

```javascript
/**
 * Example: [Short description]
 *
 * Demonstrates:
 * - Concept A
 * - Pattern B
 * - Use case C
 */

// --- Setup ---
const data = [1, 2, 3, 4, 5];

// --- Main Logic ---
const result = data
  .filter(n => n % 2 === 0)  // Keep even numbers
  .map(n => n * 2);           // Double each value

// --- Verification ---
console.log(result); // Expected: [4, 8]

// --- Automated Test ---
import { expect } from 'vitest';
expect(result).toEqual([4, 8]);
```

---

## Security Best Practices

### Input Validation

```javascript
// ✅ CORRECT: Validate and sanitize user input
const sanitizeUsername = username => {
  if (typeof username !== 'string') {
    throw new TypeError('Username must be a string');
  }

  const trimmed = username.trim();

  if (trimmed.length < 3 || trimmed.length > 20) {
    throw new Error('Username must be 3-20 characters');
  }

  // Remove any HTML/script tags
  return trimmed.replace(/<[^>]*>/g, '');
};

// ❌ WRONG: Direct usage without validation
const createUser = username => {
  document.getElementById('user').innerHTML = username; // XSS vulnerability!
};
```

### Avoid Dangerous Patterns

```javascript
// ❌ WRONG: eval is dangerous
const result = eval(userInput);

// ❌ WRONG: new Function from user input
const fn = new Function('return ' + userInput);

// ❌ WRONG: innerHTML with user content
element.innerHTML = userContent; // XSS risk

// ✅ CORRECT: Use textContent or createElement
element.textContent = userContent;

// ✅ CORRECT: Use DOMPurify for HTML sanitization
import DOMPurify from 'dompurify';
element.innerHTML = DOMPurify.sanitize(userContent);
```

### Environment Variables & Secrets

```javascript
// ✅ CORRECT: Use environment variables for secrets
const API_KEY = process.env.API_KEY;

if (!API_KEY) {
  throw new Error('API_KEY environment variable is required');
}

// ❌ WRONG: Hardcoded secrets
const API_KEY = 'sk-1234567890abcdef'; // Never do this!
```

---

## Performance Guidelines

### Prefer Modern APIs

```javascript
// ✅ CORRECT: Use fetch (modern, promise-based)
const response = await fetch(url);
const data = await response.json();

// ❌ AVOID: XMLHttpRequest (legacy, callback-based)
const xhr = new XMLHttpRequest();
xhr.open('GET', url);
```

### Avoid Common Anti-patterns

```javascript
// ❌ WRONG: Blocking the event loop
const fibonacci = n => {
  if (n <= 1) return n;
  return fibonacci(n - 1) + fibonacci(n - 2); // Exponential time!
};

// ✅ CORRECT: Use memoization or iterative approach
const fibonacci = n => {
  const cache = [0, 1];
  for (let i = 2; i <= n; i++) {
    cache[i] = cache[i - 1] + cache[i - 2];
  }
  return cache[n];
};

// ❌ WRONG: Inefficient DOM manipulation
for (let i = 0; i < 1000; i++) {
  document.body.innerHTML += `<div>${i}</div>`; // Reflows on every iteration!
}

// ✅ CORRECT: Batch DOM updates
const fragment = document.createDocumentFragment();
for (let i = 0; i < 1000; i++) {
  const div = document.createElement('div');
  div.textContent = i;
  fragment.appendChild(div);
}
document.body.appendChild(fragment); // Single reflow
```

---

## Tooling & Setup

### Required Tools

1. **Node.js:** 18.0.0+ LTS
2. **npm:** 9.0.0+ or **pnpm** 8.0.0+
3. **Editor:** VS Code recommended (with ESLint + Prettier extensions)

### VS Code Extensions

```json
{
  "recommendations": [
    "dbaeumer.vscode-eslint",
    "esbenp.prettier-vscode",
    "vitest.explorer",
    "ms-vscode.vscode-typescript-next"
  ]
}
```

### Installation

```bash
# Install dependencies
npm install

# Run validation suite
npm run validate

# Format all files
npm run format

# Fix linting issues
npm run lint:fix
```

---

## TypeScript Integration

TypeScript is **optional** but recommended for larger projects. All JavaScript examples include type annotations in comments or JSDoc.

### JSDoc for Type Safety

```javascript
/**
 * @typedef {Object} User
 * @property {string} id - Unique identifier
 * @property {string} name - User's full name
 * @property {number} age - User's age
 * @property {string[]} roles - User roles
 */

/**
 * Finds a user by ID
 * @param {User[]} users - Array of users
 * @param {string} id - User ID to find
 * @returns {User | undefined} The found user or undefined
 */
const findUserById = (users, id) => users.find(user => user.id === id);
```

### TypeScript Type Definitions

For modules, provide `.d.ts` files:

```typescript
// math.d.ts
export function add(a: number, b: number): number;
export function multiply(a: number, b: number): number;

interface MathUtils {
  add: typeof add;
  multiply: typeof multiply;
}

export default MathUtils;
```

---

## Enforcement

All code is automatically validated through CI/CD pipelines:

- **ESLint:** Code style and quality checks
- **Prettier:** Formatting verification
- **Vitest:** Unit and integration tests
- **TypeScript:** Type checking (if applicable)

**Pre-commit hooks** (optional) can be enabled to enforce standards locally.

---

## Questions or Suggestions?

Open an issue or pull request to discuss improvements to these standards.

**Last reviewed:** 2025-11-22
**Next review:** Quarterly
